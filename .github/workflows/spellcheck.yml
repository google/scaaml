name: spellcheck
on:
  push:
    paths:
      - '**/*.py'
      - '**/*.ipynb'
      - '**/*.md'
  pull_request:
    types: [opened, synchronize, reopened]
jobs:
  list_files:
    name: List changed files
    runs-on: ubuntu-22.04
    outputs:
      files: ${{ steps.generate-matrix.outputs.files }}
    steps:
      - name: Generate matrix
        id: generate-matrix
        uses: actions/checkout@v2
        with:
          # We need all history to list all changed files.
          fetch-depth: 0
        run: |
          FILES="$(git diff --name-only origin/master..${{ github.event.after }})"
          echo ::set-output name=files::${FILES}
  spellchecking:
    runs-on: ubuntu-22.04
    needs:
      - list_files
    strategy:
      matrix:
        file: ${{ fromJSON(needs.list_files.outputs.files) }}
    steps:
      - name: Matrix => (${{ matrix.files }})
        run: |
          echo ${{ matrix.file }}
